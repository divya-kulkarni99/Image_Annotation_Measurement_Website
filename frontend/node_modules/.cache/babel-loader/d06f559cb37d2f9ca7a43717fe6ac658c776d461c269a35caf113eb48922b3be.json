{"ast":null,"code":"// Copyright 2013 Lovell Fuller and others.\n// SPDX-License-Identifier: Apache-2.0\n\n'use strict';\n\nconst fs = require('fs');\nconst os = require('os');\nconst path = require('path');\nconst spawnSync = require('child_process').spawnSync;\nconst semverCoerce = require('semver/functions/coerce');\nconst semverGreaterThanOrEqualTo = require('semver/functions/gte');\nconst platform = require('./platform');\nconst {\n  config\n} = require('../package.json');\nconst env = process.env;\nconst minimumLibvipsVersionLabelled = env.npm_package_config_libvips || /* istanbul ignore next */\nconfig.libvips;\nconst minimumLibvipsVersion = semverCoerce(minimumLibvipsVersionLabelled).version;\nconst spawnSyncOptions = {\n  encoding: 'utf8',\n  shell: true\n};\nconst vendorPath = path.join(__dirname, '..', 'vendor', minimumLibvipsVersion, platform());\nconst mkdirSync = function (dirPath) {\n  try {\n    fs.mkdirSync(dirPath, {\n      recursive: true\n    });\n  } catch (err) {\n    /* istanbul ignore next */\n    if (err.code !== 'EEXIST') {\n      throw err;\n    }\n  }\n};\nconst cachePath = function () {\n  const npmCachePath = env.npm_config_cache || ( /* istanbul ignore next */\n  env.APPDATA ? path.join(env.APPDATA, 'npm-cache') : path.join(os.homedir(), '.npm'));\n  mkdirSync(npmCachePath);\n  const libvipsCachePath = path.join(npmCachePath, '_libvips');\n  mkdirSync(libvipsCachePath);\n  return libvipsCachePath;\n};\nconst integrity = function (platformAndArch) {\n  return env[`npm_package_config_integrity_${platformAndArch.replace('-', '_')}`] || config.integrity[platformAndArch];\n};\nconst log = function (item) {\n  if (item instanceof Error) {\n    console.error(`sharp: Installation error: ${item.message}`);\n  } else {\n    console.log(`sharp: ${item}`);\n  }\n};\nconst isRosetta = function () {\n  /* istanbul ignore next */\n  if (process.platform === 'darwin' && process.arch === 'x64') {\n    const translated = spawnSync('sysctl sysctl.proc_translated', spawnSyncOptions).stdout;\n    return (translated || '').trim() === 'sysctl.proc_translated: 1';\n  }\n  return false;\n};\nconst globalLibvipsVersion = function () {\n  if (process.platform !== 'win32') {\n    const globalLibvipsVersion = spawnSync('pkg-config --modversion vips-cpp', {\n      ...spawnSyncOptions,\n      env: {\n        ...env,\n        PKG_CONFIG_PATH: pkgConfigPath()\n      }\n    }).stdout;\n    /* istanbul ignore next */\n    return (globalLibvipsVersion || '').trim();\n  } else {\n    return '';\n  }\n};\nconst hasVendoredLibvips = function () {\n  return fs.existsSync(vendorPath);\n};\n\n/* istanbul ignore next */\nconst removeVendoredLibvips = function () {\n  fs.rmSync(vendorPath, {\n    recursive: true,\n    maxRetries: 3,\n    force: true\n  });\n};\n\n/* istanbul ignore next */\nconst pkgConfigPath = function () {\n  if (process.platform !== 'win32') {\n    const brewPkgConfigPath = spawnSync('which brew >/dev/null 2>&1 && brew environment --plain | grep PKG_CONFIG_LIBDIR | cut -d\" \" -f2', spawnSyncOptions).stdout || '';\n    return [brewPkgConfigPath.trim(), env.PKG_CONFIG_PATH, '/usr/local/lib/pkgconfig', '/usr/lib/pkgconfig', '/usr/local/libdata/pkgconfig', '/usr/libdata/pkgconfig'].filter(Boolean).join(':');\n  } else {\n    return '';\n  }\n};\nconst useGlobalLibvips = function () {\n  if (Boolean(env.SHARP_IGNORE_GLOBAL_LIBVIPS) === true) {\n    return false;\n  }\n  /* istanbul ignore next */\n  if (isRosetta()) {\n    log('Detected Rosetta, skipping search for globally-installed libvips');\n    return false;\n  }\n  const globalVipsVersion = globalLibvipsVersion();\n  return !!globalVipsVersion && /* istanbul ignore next */\n  semverGreaterThanOrEqualTo(globalVipsVersion, minimumLibvipsVersion);\n};\nmodule.exports = {\n  minimumLibvipsVersion,\n  minimumLibvipsVersionLabelled,\n  cachePath,\n  integrity,\n  log,\n  globalLibvipsVersion,\n  hasVendoredLibvips,\n  removeVendoredLibvips,\n  pkgConfigPath,\n  useGlobalLibvips,\n  mkdirSync\n};","map":{"version":3,"names":["fs","require","os","path","spawnSync","semverCoerce","semverGreaterThanOrEqualTo","platform","config","env","process","minimumLibvipsVersionLabelled","npm_package_config_libvips","libvips","minimumLibvipsVersion","version","spawnSyncOptions","encoding","shell","vendorPath","join","__dirname","mkdirSync","dirPath","recursive","err","code","cachePath","npmCachePath","npm_config_cache","APPDATA","homedir","libvipsCachePath","integrity","platformAndArch","replace","log","item","Error","console","error","message","isRosetta","arch","translated","stdout","trim","globalLibvipsVersion","PKG_CONFIG_PATH","pkgConfigPath","hasVendoredLibvips","existsSync","removeVendoredLibvips","rmSync","maxRetries","force","brewPkgConfigPath","filter","Boolean","useGlobalLibvips","SHARP_IGNORE_GLOBAL_LIBVIPS","globalVipsVersion","module","exports"],"sources":["/Users/divyakulkarni/Desktop/IAMW/image-annotation-measurement/node_modules/sharp/lib/libvips.js"],"sourcesContent":["// Copyright 2013 Lovell Fuller and others.\n// SPDX-License-Identifier: Apache-2.0\n\n'use strict';\n\nconst fs = require('fs');\nconst os = require('os');\nconst path = require('path');\nconst spawnSync = require('child_process').spawnSync;\nconst semverCoerce = require('semver/functions/coerce');\nconst semverGreaterThanOrEqualTo = require('semver/functions/gte');\n\nconst platform = require('./platform');\nconst { config } = require('../package.json');\n\nconst env = process.env;\nconst minimumLibvipsVersionLabelled = env.npm_package_config_libvips || /* istanbul ignore next */\n  config.libvips;\nconst minimumLibvipsVersion = semverCoerce(minimumLibvipsVersionLabelled).version;\n\nconst spawnSyncOptions = {\n  encoding: 'utf8',\n  shell: true\n};\n\nconst vendorPath = path.join(__dirname, '..', 'vendor', minimumLibvipsVersion, platform());\n\nconst mkdirSync = function (dirPath) {\n  try {\n    fs.mkdirSync(dirPath, { recursive: true });\n  } catch (err) {\n    /* istanbul ignore next */\n    if (err.code !== 'EEXIST') {\n      throw err;\n    }\n  }\n};\n\nconst cachePath = function () {\n  const npmCachePath = env.npm_config_cache || /* istanbul ignore next */\n    (env.APPDATA ? path.join(env.APPDATA, 'npm-cache') : path.join(os.homedir(), '.npm'));\n  mkdirSync(npmCachePath);\n  const libvipsCachePath = path.join(npmCachePath, '_libvips');\n  mkdirSync(libvipsCachePath);\n  return libvipsCachePath;\n};\n\nconst integrity = function (platformAndArch) {\n  return env[`npm_package_config_integrity_${platformAndArch.replace('-', '_')}`] || config.integrity[platformAndArch];\n};\n\nconst log = function (item) {\n  if (item instanceof Error) {\n    console.error(`sharp: Installation error: ${item.message}`);\n  } else {\n    console.log(`sharp: ${item}`);\n  }\n};\n\nconst isRosetta = function () {\n  /* istanbul ignore next */\n  if (process.platform === 'darwin' && process.arch === 'x64') {\n    const translated = spawnSync('sysctl sysctl.proc_translated', spawnSyncOptions).stdout;\n    return (translated || '').trim() === 'sysctl.proc_translated: 1';\n  }\n  return false;\n};\n\nconst globalLibvipsVersion = function () {\n  if (process.platform !== 'win32') {\n    const globalLibvipsVersion = spawnSync('pkg-config --modversion vips-cpp', {\n      ...spawnSyncOptions,\n      env: {\n        ...env,\n        PKG_CONFIG_PATH: pkgConfigPath()\n      }\n    }).stdout;\n    /* istanbul ignore next */\n    return (globalLibvipsVersion || '').trim();\n  } else {\n    return '';\n  }\n};\n\nconst hasVendoredLibvips = function () {\n  return fs.existsSync(vendorPath);\n};\n\n/* istanbul ignore next */\nconst removeVendoredLibvips = function () {\n  fs.rmSync(vendorPath, { recursive: true, maxRetries: 3, force: true });\n};\n\n/* istanbul ignore next */\nconst pkgConfigPath = function () {\n  if (process.platform !== 'win32') {\n    const brewPkgConfigPath = spawnSync(\n      'which brew >/dev/null 2>&1 && brew environment --plain | grep PKG_CONFIG_LIBDIR | cut -d\" \" -f2',\n      spawnSyncOptions\n    ).stdout || '';\n    return [\n      brewPkgConfigPath.trim(),\n      env.PKG_CONFIG_PATH,\n      '/usr/local/lib/pkgconfig',\n      '/usr/lib/pkgconfig',\n      '/usr/local/libdata/pkgconfig',\n      '/usr/libdata/pkgconfig'\n    ].filter(Boolean).join(':');\n  } else {\n    return '';\n  }\n};\n\nconst useGlobalLibvips = function () {\n  if (Boolean(env.SHARP_IGNORE_GLOBAL_LIBVIPS) === true) {\n    return false;\n  }\n  /* istanbul ignore next */\n  if (isRosetta()) {\n    log('Detected Rosetta, skipping search for globally-installed libvips');\n    return false;\n  }\n  const globalVipsVersion = globalLibvipsVersion();\n  return !!globalVipsVersion && /* istanbul ignore next */\n    semverGreaterThanOrEqualTo(globalVipsVersion, minimumLibvipsVersion);\n};\n\nmodule.exports = {\n  minimumLibvipsVersion,\n  minimumLibvipsVersionLabelled,\n  cachePath,\n  integrity,\n  log,\n  globalLibvipsVersion,\n  hasVendoredLibvips,\n  removeVendoredLibvips,\n  pkgConfigPath,\n  useGlobalLibvips,\n  mkdirSync\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}